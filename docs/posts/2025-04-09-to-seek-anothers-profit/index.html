<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-04-09">

<title>To seek another’s profit – Two Points Make a Line</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../..//images/logo-icon.png" rel="icon" type="image/png">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-f15e99efc467935327b39df0f69534b5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-EJMC44PZ56"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-EJMC44PZ56', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<script type="module" src="../../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


<meta property="og:title" content="To seek another’s profit – Two Points Make a Line">
<meta property="og:description" content="One hundred years ago, the U.S. granted the Philippines access to its highly protected markets. What seemed like a sweet deal came with a cost">
<meta property="og:image" content="https://twopoints.blog/posts/2025-04-09-to-seek-anothers-profit/thumbnail.png">
<meta property="og:site_name" content="Two Points Make a Line">
<meta property="og:image:height" content="819">
<meta property="og:image:width" content="1200">
<meta name="twitter:title" content="To seek another’s profit – Two Points Make a Line">
<meta name="twitter:description" content="One hundred years ago, the U.S. granted the Philippines access to its highly protected markets. What seemed like a sweet deal came with a cost">
<meta name="twitter:image" content="https://twopoints.blog/posts/2025-04-09-to-seek-anothers-profit/thumbnail.png">
<meta name="twitter:image-height" content="819">
<meta name="twitter:image-width" content="1200">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo-icon-invert.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Two Points Make a Line</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <span class="nav-link">
<span class="menu-text">Telling stories through visualized data — by Kenneth S. Reyes</span>
    </span>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ksreyes/twopoints"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">To seek another’s profit</h1>
<p class="subtitle lead">One hundred years ago, the U.S. granted the Philippines access to its highly protected markets. What seemed like a sweet deal came with a cost</p>
  <div class="quarto-categories">
    <div class="quarto-category">D3/OJS</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 9, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>The bulk of President Donald Trump’s <a href="https://www.wsj.com/economy/trade/trump-tariffs-list-products-canada-mexico-china-b41351df">Liberation Day tariffs</a> took effect today. Together with prior levies, these usher in the steepest set of tariff hikes the United States has seen since the <a href="https://www.piie.com/blogs/realtime-economics/2025/historic-significance-trumps-tariff-actions">Smoot–Hawley Tariff Act of 1930</a>. As countries consider retaliation, the global trade order hangs in the balance.</p>
<p>This article is not about these tariffs, but the tariffs of one hundred years ago. Questions over their contribution to the Great Depression or even the First World War are both fascinating and horrifying. But what I want to recount here is a lesser known by-product of that time. When the U.S. erected those tariff walls, it enclosed not just itself but its colony on the other side of the world, the Philippines. What followed is a compelling case study of how top-down policymaking led to profound unintended consequences — consequences that reverberate in the Philippines to this day.</p>
<section id="little-brown-brothers" class="level2">
<h2 class="anchored" data-anchor-id="little-brown-brothers">Little brown brothers</h2>
<p>Outside the Philippines, it is not well known that the United States occupied the country for close to 50 years, though aspects of it have entered popular knowledge. Rudyard Kipling’s 1899 poem “<a href="https://en.wikipedia.org/wiki/The_White_Man%27s_Burden">The White Man’s Burden</a>” was a plea in support of imperialism in the Philippines, not Africa. The word “<a href="https://en.wikipedia.org/wiki/Boondocks">boondocks</a>” was borrowed from the Tagalog word for “mountain” by American soldiers sent to pacify the country.</p>
<p>Nearly everything about the occupation was an accident. Situated on the other side of the globe, the Philippine Islands held no strategic, economic, or cultural significance for the United States. But it was a Spanish possession, and when the United States defeated Spain in their <a href="https://en.wikipedia.org/wiki/Spanish%E2%80%93American_War">1898 war</a> for control over the Caribbean, the Philippines was part of the spoils. There was initially some debate over whether to retain the Islands, but President William McKinley, who couldn’t locate them on a map, ultimately pushed for their <a href="https://en.wikipedia.org/wiki/Treaty_of_Paris_(1898)">acquisition</a> from Spain for what today amounts to $760 million.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" data-startfrom="36" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 35;"><span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dim <span class="op">=</span> { <span class="dt">width</span><span class="op">:</span> <span class="dv">790</span><span class="op">,</span> <span class="dt">height</span><span class="op">:</span> <span class="dv">400</span> }<span class="op">;</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> topojson<span class="op">.</span><span class="fu">feature</span>(map<span class="op">,</span> map<span class="op">.</span><span class="at">objects</span><span class="op">.</span><span class="at">countries</span>)<span class="op">;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chart title //////////////////////////////</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> container <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"div"</span>)<span class="op">;</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-title"</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Benevolent assimilation"</span>)<span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-subtitle"</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin-bottom"</span><span class="op">,</span> <span class="st">"1rem"</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"The United States and the Philippines"</span>)<span class="op">;</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Map //////////////////////////////////////</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> projection <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoNaturalEarth1</span>()</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">scale</span>(<span class="dv">150</span>)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">center</span>([<span class="dv">50</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span>])<span class="op">;</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> path <span class="op">=</span> d3<span class="op">.</span><span class="fu">geoPath</span>()<span class="op">.</span><span class="fu">projection</span>(projection)<span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> svg <span class="op">=</span> container<span class="op">.</span><span class="fu">append</span>(<span class="st">"svg"</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="st">"100%"</span>)</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> dim<span class="op">.</span><span class="at">width</span><span class="op">,</span> dim<span class="op">.</span><span class="at">height</span>])<span class="op">;</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"path"</span>)</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">data</span>(data<span class="op">.</span><span class="at">features</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">join</span>(<span class="st">"path"</span>)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> path)</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> {</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">switch</span>(d<span class="op">.</span><span class="at">properties</span><span class="op">.</span><span class="at">iso3c</span>) {</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">"USA"</span><span class="op">:</span> </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> colors<span class="op">.</span><span class="at">blue</span><span class="op">;</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>          <span class="cf">case</span> <span class="st">"PHL"</span><span class="op">:</span> </span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> colors<span class="op">.</span><span class="at">blue</span><span class="op">;</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>          <span class="cf">default</span><span class="op">:</span> </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> colors<span class="op">.</span><span class="at">land</span><span class="op">;</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"none"</span>)<span class="op">;</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chart sources ////////////////////////////</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-source"</span>)</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin"</span><span class="op">,</span> <span class="st">".5rem 0"</span>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"line-height"</span><span class="op">,</span> <span class="fl">1.25</span>)</span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">html</span>(<span class="vs">`"When we received the cable from Admiral Dewey telling of the taking of the Philippines I looked up their location on the globe. I could not have told where those darned islands were within 2,000 miles!" – William McKinley, quoted in H. H. Kohlsaat, &lt;a href='https://dn790007.ca.archive.org/0/items/frommckinleytoha00kohl/frommckinleytoha00kohl.pdf'&gt;&lt;i&gt;From McKinley to Harding&lt;/i&gt;&lt;/a&gt; (1923), p. 68.`</span>)<span class="op">;</span></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> container<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="expression">

</div>
</div>
</div>
<p>The McKinley government was eager to display an enlightened brand of colonialism, focusing on education, health, and economic development for their “little brown brothers”. Nevermind the independence movement that had to be crushed in a <a href="https://en.wikipedia.org/wiki/Philippine%E2%80%93American_War">three-year war</a>. As areas were pacified, the Islands’ first and most consequential American governor, future president William Howard Taft, wasted no time setting up local governments. He did this in collaboration with local elites, whom he appointed to positions of power. When formal elections were later held, those same elites, who derived their wealth from land, handily won.</p>
<p>It was Taft’s belief that the best way to spur economic development in the Philippines was through mutual free trade with the United States. On the face of it, this is sound, even generous, policy. Philippine producers would profit from selling to the far wealthier markets of America, enriching the Islands. Unfortunately, there were two fundamental problems to this plan.</p>
<p>First, the United States at the time had erected very high tariff walls — a rate of over 40% on dutiable imports on average. The only way free trade with the Philippines can work is if the Philippines enacted similarly high tariffs; otherwise, third countries can circumvent U.S. tariffs through its colony. Thus, the <a href="https://en.wikipedia.org/wiki/Payne%E2%80%93Aldrich_Tariff_Act">1909 Payne–Aldrich Tariff Act</a>, while abolishing trade barriers between the U.S. and the Philippines, enclosed the two within the same prohibitive walls. For better or worse, Philippine trade had become firmly affixed to the United States.</p>
<p>Moreover, the Philippines’ main export to the U.S. was hemp, which <em>already entered duty-free</em>. There were no hemp producers in America that could be threatened by cheap hemp imports. Instead, due to Payne–Aldrich, another export suddenly received extremely high rates of protection: sugar. The policy of free trade became a boon to a single industry.</p>
</section>
<section id="the-sweetness-of-protection" class="level2">
<h2 class="anchored" data-anchor-id="the-sweetness-of-protection">The sweetness of protection</h2>
<p>The sugar industry in the Philippines had been growing since the 1820s alongside growth in world demand. But it was just one of many producers and competition was stiff. Moreover, yields were depressed and the adoption of advanced milling techniques was slow, resulting in sugar that was both expensive to produce and of poor quality. An argument could be made that had it not been for the windfall that access to U.S. markets granted, the industry would not have had long to live.</p>
<p>Instead, it flourished.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" data-startfrom="111" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 110;"><span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dim <span class="op">=</span> { <span class="dt">width</span><span class="op">:</span> <span class="dv">790</span><span class="op">,</span> <span class="dt">height</span><span class="op">:</span> <span class="dv">550</span> }<span class="op">;</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">50</span> }<span class="op">;</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> gutter <span class="op">=</span> { <span class="dt">x</span><span class="op">:</span> <span class="fl">12.5</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fl">12.5</span><span class="op">,</span> <span class="dt">yin</span><span class="op">:</span> <span class="dv">10</span> }<span class="op">;</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> sugarexp<span class="op">;</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(d3<span class="op">.</span><span class="fu">extent</span>(data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">t</span>))</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> gutter<span class="op">.</span><span class="at">yin</span><span class="op">,</span> dim<span class="op">.</span><span class="at">width</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">-</span> gutter<span class="op">.</span><span class="at">yin</span>])<span class="op">;</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(d3<span class="op">.</span><span class="fu">extent</span>(data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">n</span>))</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">;</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chart title //////////////////////////////</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> container <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"div"</span>)<span class="op">;</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-title"</span>)</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Sugar rush"</span>)<span class="op">;</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-subtitle"</span>)</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin-bottom"</span><span class="op">,</span> <span class="st">"1rem"</span>)</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Philippine sugar exports in metric tons, 1836–1938"</span>)<span class="op">;</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Line /////////////////////////////////////</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> svg <span class="op">=</span> container<span class="op">.</span><span class="fu">append</span>(<span class="st">"svg"</span>)</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="st">"100%"</span>)</span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> dim<span class="op">.</span><span class="at">width</span><span class="op">,</span> dim<span class="op">.</span><span class="at">height</span>])<span class="op">;</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">curve</span>(d3<span class="op">.</span><span class="at">curveBasis</span>)</span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">t</span>))</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">n</span>))<span class="op">;</span></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> lines <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">datum</span>(data)</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> line)</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> colors<span class="op">.</span><span class="at">blue</span>)</span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Axes /////////////////////////////////////</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> xAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(x)</span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickFormat</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>))</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickSize</span>(<span class="dv">0</span>)</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickPadding</span>([gutter<span class="op">.</span><span class="at">x</span>])<span class="op">;</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(y)</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">ticks</span>(<span class="dv">5</span><span class="op">,</span> <span class="st">".1s"</span>)</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickSize</span>(<span class="dv">0</span>)</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickPadding</span>([gutter<span class="op">.</span><span class="at">y</span>])<span class="op">;</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> xAxisGroup <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span> dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(xAxis)<span class="op">;</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yAxisGroup <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span> margin<span class="op">.</span><span class="at">left</span> <span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="op">-</span>margin<span class="op">.</span><span class="at">left</span>)</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span> <span class="op">+</span> <span class="dv">20</span>)</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".9rem"</span>)</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="st">"Metric tons"</span>))<span class="op">;</span></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>    xAxisGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".8rem"</span>)<span class="op">;</span></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>    yAxisGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".8rem"</span>)<span class="op">;</span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Annotations ////////////////////////////</span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">call</span>(addMarker<span class="op">,</span> <span class="dv">1909</span><span class="op">,</span> <span class="st">"Payne–Aldrich"</span><span class="op">,</span> <span class="dv">400</span>)<span class="op">;</span></span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">call</span>(addMarker<span class="op">,</span> <span class="dv">1930</span><span class="op">,</span> <span class="st">"Smoot–Hawley"</span><span class="op">,</span> <span class="dv">400</span>)<span class="op">;</span></span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".9rem"</span>)</span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(<span class="dv">1909</span>))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">-</span> <span class="dv">355</span>)</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span>)</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="st">"Mutual free trade"</span>)</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="st">"with U.S."</span>)</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(<span class="dv">1909</span>))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">-</span> <span class="dv">355</span>)</span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">addMarker</span>(container<span class="op">,</span> year<span class="op">,</span> name<span class="op">,</span> ypos) {</span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> marker <span class="op">=</span> container<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>      marker<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="vs">`M</span><span class="sc">${</span> <span class="fu">x</span>(year) <span class="sc">}</span><span class="vs">,</span></span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a><span class="vs">          </span><span class="sc">${</span> dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="sc">}</span><span class="vs"> V</span><span class="sc">${</span> margin<span class="op">.</span><span class="at">top</span> <span class="sc">}</span><span class="vs">`</span></span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"4 2"</span>)<span class="op">;</span></span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>      marker<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".9rem"</span>)</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(year))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">-</span> ypos)</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span>)</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(name)</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(<span class="st">"Tariff Act"</span>)</span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(year))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="op">-</span> ypos)</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="op">-</span><span class="dv">10</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> container<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chart sources ////////////////////////////</span></span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-source"</span>)</span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin"</span><span class="op">,</span> <span class="st">".5rem 0"</span>)</span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"line-height"</span><span class="op">,</span> <span class="fl">1.25</span>)</span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">html</span>(<span class="vs">`Source: J. Larkin, &lt;a href="https://publishing.cdlib.org/ucpressebooks/view?docId=ft4580066d&amp;chunk.id=d0e11113&amp;toc.depth=1&amp;toc.id=&amp;brand=ucpress/"&gt;&lt;i&gt;Sugar and the Origins of Modern Philippine Society&lt;/i&gt;&lt;/a&gt; (1993), Appendix A, p. 250; Philippine Bureau of Customs, &lt;i&gt;Report&lt;/i&gt; (1940), Table 7, pp. 105–106.`</span>)<span class="op">;</span></span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> container<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="expression">

</div>
</div>
</div>
<p>Plantation crops like sugar cane have long been associated with <a href="https://pubs.aeaweb.org/doi/pdfplus/10.1257/jep.14.3.217">high inequality</a>. Such enterprises are typically supported by an economic structure where wealth and political power accumulate to an elite few. In the case of sugar, not only does cultivating the crop require abundant labor, it must also be milled immediately to avoid spoilage. To make the enterprise viable, millers and landholders are incentivized to exert maximum control over farmhands, either through outright slavery as in <a href="https://education.nationalgeographic.org/resource/plantation-system/">the American South and the Caribbean</a>, or, after slavery was abolished, through <a href="https://www.nber.org/system/files/working_papers/w20958/w20958.pdf">legal coercion</a>. Lacking outside options or the capital to put up competing mills, farmhands are left subservient.</p>
<p>This leads to the second problem of Taft’s plan, which is that whatever gains free trade brought, they were concentrated in the hands of an unchecked landed elite. Indeed, it was the Americans’ belief that what benefited these elites (the only Filipinos they interacted with) benefited the country as a whole. The elites, in turn, converted their fabulous wealth into political power. While nominally a democracy, a handful of prominent families functioned as an aristocratic class who passed down elective office like hereditary titles. Coupled with the use of paramilitary forces, the country slipped into what has been described as an “<a href="https://history.wisc.edu/publications/an-anarchy-of-families-state-and-family-in-the-philippines/">anarchy of families</a>”.</p>
<p>Taft’s plan, while intended as a form of economic aid, in practice amounted to a massive wealth transfer to an already privileged class. As the Philippine economy ossified around access to U.S. markets, economic and political leaders found little incentive to develop anything other than the extractive industry that generated their easy wealth. Rent-seeking, and not productive investment, became the dominant activity.</p>
</section>
<section id="aftermath" class="level2">
<h2 class="anchored" data-anchor-id="aftermath">Aftermath</h2>
<p>By the 1930s, the share of the U.S. in Philippine exports reached 80%. Sugar was roughly half of total exports and virtually all of it was sold to the U.S. It was a perilous reliance on a single product sold in a single market. Such was the vested interest in this arrangement that many Filipino elites actively worked against independence when the opportunity arose.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" data-startfrom="258" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 257;"><span id="cb3-258"><a href="#cb3-258" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb3-259"><a href="#cb3-259" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dim <span class="op">=</span> { <span class="dt">width</span><span class="op">:</span> <span class="dv">790</span><span class="op">,</span> <span class="dt">height</span><span class="op">:</span> <span class="dv">550</span> }<span class="op">;</span></span>
<span id="cb3-260"><a href="#cb3-260" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> margin <span class="op">=</span> { <span class="dt">top</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">right</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">bottom</span><span class="op">:</span> <span class="dv">50</span><span class="op">,</span> <span class="dt">left</span><span class="op">:</span> <span class="dv">50</span> }<span class="op">;</span></span>
<span id="cb3-261"><a href="#cb3-261" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> gutter <span class="op">=</span> { <span class="dt">x</span><span class="op">:</span> <span class="fl">12.5</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="fl">12.5</span><span class="op">,</span> <span class="dt">yin</span><span class="op">:</span> <span class="dv">10</span> }<span class="op">;</span></span>
<span id="cb3-262"><a href="#cb3-262" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-263"><a href="#cb3-263" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> dataWide <span class="op">=</span> exports<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> ({</span>
<span id="cb3-264"><a href="#cb3-264" aria-hidden="true" tabindex="-1"></a>      <span class="dt">t</span><span class="op">:</span> d<span class="op">.</span><span class="at">t</span><span class="op">,</span></span>
<span id="cb3-265"><a href="#cb3-265" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sh_usa</span><span class="op">:</span> <span class="op">+</span>d<span class="op">.</span><span class="at">x_usa</span> <span class="op">/</span> <span class="op">+</span>d<span class="op">.</span><span class="at">x</span><span class="op">,</span></span>
<span id="cb3-266"><a href="#cb3-266" aria-hidden="true" tabindex="-1"></a>      <span class="dt">sh_sug_usa</span><span class="op">:</span> <span class="op">+</span>d<span class="op">.</span><span class="at">x_usa_sug</span> <span class="op">/</span> <span class="op">+</span>d<span class="op">.</span><span class="at">x_sug</span></span>
<span id="cb3-267"><a href="#cb3-267" aria-hidden="true" tabindex="-1"></a>    }))<span class="op">;</span></span>
<span id="cb3-268"><a href="#cb3-268" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-269"><a href="#cb3-269" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> dataWide<span class="op">.</span><span class="fu">flatMap</span>(d <span class="kw">=&gt;</span> [</span>
<span id="cb3-270"><a href="#cb3-270" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">t</span><span class="op">:</span> d<span class="op">.</span><span class="at">t</span><span class="op">,</span> <span class="kw">var</span><span class="op">:</span> <span class="st">"sh_usa"</span><span class="op">,</span> <span class="dt">v</span><span class="op">:</span> d<span class="op">.</span><span class="at">sh_usa</span> }<span class="op">,</span></span>
<span id="cb3-271"><a href="#cb3-271" aria-hidden="true" tabindex="-1"></a>      { <span class="dt">t</span><span class="op">:</span> d<span class="op">.</span><span class="at">t</span><span class="op">,</span> <span class="kw">var</span><span class="op">:</span> <span class="st">"sh_sug_usa"</span><span class="op">,</span> <span class="dt">v</span><span class="op">:</span> d<span class="op">.</span><span class="at">sh_sug_usa</span> }<span class="op">,</span></span>
<span id="cb3-272"><a href="#cb3-272" aria-hidden="true" tabindex="-1"></a>    ])<span class="op">;</span></span>
<span id="cb3-273"><a href="#cb3-273" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-274"><a href="#cb3-274" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-275"><a href="#cb3-275" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>(d3<span class="op">.</span><span class="fu">extent</span>(data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">t</span>))</span>
<span id="cb3-276"><a href="#cb3-276" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([margin<span class="op">.</span><span class="at">left</span> <span class="op">+</span> gutter<span class="op">.</span><span class="at">yin</span><span class="op">,</span> dim<span class="op">.</span><span class="at">width</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">right</span> <span class="op">-</span> gutter<span class="op">.</span><span class="at">yin</span>])<span class="op">;</span></span>
<span id="cb3-277"><a href="#cb3-277" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-278"><a href="#cb3-278" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleLinear</span>()</span>
<span id="cb3-279"><a href="#cb3-279" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>([<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>])</span>
<span id="cb3-280"><a href="#cb3-280" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span><span class="op">,</span> margin<span class="op">.</span><span class="at">top</span>])<span class="op">;</span></span>
<span id="cb3-281"><a href="#cb3-281" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-282"><a href="#cb3-282" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chart title //////////////////////////////</span></span>
<span id="cb3-283"><a href="#cb3-283" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-284"><a href="#cb3-284" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> container <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"div"</span>)<span class="op">;</span></span>
<span id="cb3-285"><a href="#cb3-285" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-286"><a href="#cb3-286" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb3-287"><a href="#cb3-287" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-title"</span>)</span>
<span id="cb3-288"><a href="#cb3-288" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"Purchasing power"</span>)<span class="op">;</span></span>
<span id="cb3-289"><a href="#cb3-289" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-290"><a href="#cb3-290" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb3-291"><a href="#cb3-291" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-subtitle"</span>)</span>
<span id="cb3-292"><a href="#cb3-292" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin-bottom"</span><span class="op">,</span> <span class="st">"1rem"</span>)</span>
<span id="cb3-293"><a href="#cb3-293" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">text</span>(<span class="st">"The United States in Philippine exports, 1899–1938"</span>)<span class="op">;</span></span>
<span id="cb3-294"><a href="#cb3-294" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-295"><a href="#cb3-295" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Line /////////////////////////////////////</span></span>
<span id="cb3-296"><a href="#cb3-296" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-297"><a href="#cb3-297" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> svg <span class="op">=</span> container<span class="op">.</span><span class="fu">append</span>(<span class="st">"svg"</span>)</span>
<span id="cb3-298"><a href="#cb3-298" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="st">"100%"</span>)</span>
<span id="cb3-299"><a href="#cb3-299" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> dim<span class="op">.</span><span class="at">width</span><span class="op">,</span> dim<span class="op">.</span><span class="at">height</span>])</span>
<span id="cb3-300"><a href="#cb3-300" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-301"><a href="#cb3-301" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> groups <span class="op">=</span> d3<span class="op">.</span><span class="fu">group</span>(data<span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">var</span>)<span class="op">;</span></span>
<span id="cb3-302"><a href="#cb3-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-303"><a href="#cb3-303" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> line <span class="op">=</span> d3<span class="op">.</span><span class="fu">line</span>()</span>
<span id="cb3-304"><a href="#cb3-304" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">curve</span>(d3<span class="op">.</span><span class="at">curveBasis</span>)</span>
<span id="cb3-305"><a href="#cb3-305" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">x</span>(d <span class="kw">=&gt;</span> <span class="fu">x</span>(d<span class="op">.</span><span class="at">t</span>))</span>
<span id="cb3-306"><a href="#cb3-306" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">y</span>(d <span class="kw">=&gt;</span> <span class="fu">y</span>(d<span class="op">.</span><span class="at">v</span>))<span class="op">;</span></span>
<span id="cb3-307"><a href="#cb3-307" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-308"><a href="#cb3-308" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> color <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleOrdinal</span>()</span>
<span id="cb3-309"><a href="#cb3-309" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">domain</span>([<span class="st">"sh_usa"</span><span class="op">,</span> <span class="st">"sh_sug_usa"</span>])</span>
<span id="cb3-310"><a href="#cb3-310" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">range</span>([colors<span class="op">.</span><span class="at">blue</span><span class="op">,</span> colors<span class="op">.</span><span class="at">red</span>])<span class="op">;</span></span>
<span id="cb3-311"><a href="#cb3-311" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-312"><a href="#cb3-312" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> lines <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb3-313"><a href="#cb3-313" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-314"><a href="#cb3-314" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> [key<span class="op">,</span> values] <span class="kw">of</span> groups) {</span>
<span id="cb3-315"><a href="#cb3-315" aria-hidden="true" tabindex="-1"></a>      lines<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-316"><a href="#cb3-316" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb3-317"><a href="#cb3-317" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">datum</span>(values)</span>
<span id="cb3-318"><a href="#cb3-318" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> line)</span>
<span id="cb3-319"><a href="#cb3-319" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"none"</span>)</span>
<span id="cb3-320"><a href="#cb3-320" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="fu">color</span>(key))</span>
<span id="cb3-321"><a href="#cb3-321" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb3-322"><a href="#cb3-322" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-323"><a href="#cb3-323" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-324"><a href="#cb3-324" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Axes /////////////////////////////////////</span></span>
<span id="cb3-325"><a href="#cb3-325" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-326"><a href="#cb3-326" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> xAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisBottom</span>(x)</span>
<span id="cb3-327"><a href="#cb3-327" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickFormat</span>(d3<span class="op">.</span><span class="fu">format</span>(<span class="st">".0f"</span>))</span>
<span id="cb3-328"><a href="#cb3-328" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickSize</span>(<span class="dv">0</span>)</span>
<span id="cb3-329"><a href="#cb3-329" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickPadding</span>([gutter<span class="op">.</span><span class="at">x</span>])<span class="op">;</span></span>
<span id="cb3-330"><a href="#cb3-330" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-331"><a href="#cb3-331" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yAxis <span class="op">=</span> d3<span class="op">.</span><span class="fu">axisLeft</span>(y)</span>
<span id="cb3-332"><a href="#cb3-332" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">ticks</span>(<span class="dv">5</span><span class="op">,</span> <span class="st">".0%"</span>)</span>
<span id="cb3-333"><a href="#cb3-333" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickSize</span>(<span class="dv">0</span>)</span>
<span id="cb3-334"><a href="#cb3-334" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">tickPadding</span>([gutter<span class="op">.</span><span class="at">y</span>])<span class="op">;</span></span>
<span id="cb3-335"><a href="#cb3-335" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-336"><a href="#cb3-336" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> xAxisGroup <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-337"><a href="#cb3-337" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0, </span><span class="sc">${</span> dim<span class="op">.</span><span class="at">height</span> <span class="op">-</span> margin<span class="op">.</span><span class="at">bottom</span> <span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb3-338"><a href="#cb3-338" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(xAxis)<span class="op">;</span></span>
<span id="cb3-339"><a href="#cb3-339" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-340"><a href="#cb3-340" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> yAxisGroup <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-341"><a href="#cb3-341" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span> margin<span class="op">.</span><span class="at">left</span> <span class="sc">}</span><span class="vs">, 0)`</span>)</span>
<span id="cb3-342"><a href="#cb3-342" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(yAxis)</span>
<span id="cb3-343"><a href="#cb3-343" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">select</span>(<span class="st">".domain"</span>)<span class="op">.</span><span class="fu">remove</span>())<span class="op">;</span></span>
<span id="cb3-344"><a href="#cb3-344" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-345"><a href="#cb3-345" aria-hidden="true" tabindex="-1"></a>    xAxisGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".8rem"</span>)<span class="op">;</span></span>
<span id="cb3-346"><a href="#cb3-346" aria-hidden="true" tabindex="-1"></a>    yAxisGroup<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".8rem"</span>)<span class="op">;</span></span>
<span id="cb3-347"><a href="#cb3-347" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-348"><a href="#cb3-348" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Annotations ////////////////////////////</span></span>
<span id="cb3-349"><a href="#cb3-349" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-350"><a href="#cb3-350" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-351"><a href="#cb3-351" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-352"><a href="#cb3-352" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(<span class="dv">1923</span>))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(<span class="op">.</span><span class="dv">64</span>))</span>
<span id="cb3-353"><a href="#cb3-353" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb3-354"><a href="#cb3-354" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".9rem"</span>)</span>
<span id="cb3-355"><a href="#cb3-355" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb3-356"><a href="#cb3-356" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> colors<span class="op">.</span><span class="at">blue</span>)</span>
<span id="cb3-357"><a href="#cb3-357" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb3-358"><a href="#cb3-358" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="st">"Share of U.S."</span>)</span>
<span id="cb3-359"><a href="#cb3-359" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb3-360"><a href="#cb3-360" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="st">"in total exports"</span>)</span>
<span id="cb3-361"><a href="#cb3-361" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(<span class="dv">1923</span>))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(<span class="op">.</span><span class="dv">64</span>))</span>
<span id="cb3-362"><a href="#cb3-362" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-363"><a href="#cb3-363" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-364"><a href="#cb3-364" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-365"><a href="#cb3-365" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-366"><a href="#cb3-366" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(<span class="dv">1925</span>))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(<span class="op">.</span><span class="dv">98</span>))</span>
<span id="cb3-367"><a href="#cb3-367" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"end"</span>)</span>
<span id="cb3-368"><a href="#cb3-368" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".9rem"</span>)</span>
<span id="cb3-369"><a href="#cb3-369" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">"bold"</span>)</span>
<span id="cb3-370"><a href="#cb3-370" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"fill"</span><span class="op">,</span> colors<span class="op">.</span><span class="at">red</span>)</span>
<span id="cb3-371"><a href="#cb3-371" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb3-372"><a href="#cb3-372" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="st">"Share of U.S."</span>)</span>
<span id="cb3-373"><a href="#cb3-373" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb3-374"><a href="#cb3-374" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">text</span>(<span class="st">"in sugar exports"</span>)</span>
<span id="cb3-375"><a href="#cb3-375" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(<span class="dv">1925</span>))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(<span class="op">.</span><span class="dv">98</span>))</span>
<span id="cb3-376"><a href="#cb3-376" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-377"><a href="#cb3-377" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-378"><a href="#cb3-378" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">call</span>(addMarker<span class="op">,</span> <span class="dv">1909</span><span class="op">,</span> <span class="st">"Payne–Aldrich"</span><span class="op">,</span> <span class="op">.</span><span class="bn">075</span>)<span class="op">;</span></span>
<span id="cb3-379"><a href="#cb3-379" aria-hidden="true" tabindex="-1"></a>    svg<span class="op">.</span><span class="fu">call</span>(addMarker<span class="op">,</span> <span class="dv">1930</span><span class="op">,</span> <span class="st">"Smoot–Hawley"</span><span class="op">,</span> <span class="op">.</span><span class="bn">075</span>)<span class="op">;</span></span>
<span id="cb3-380"><a href="#cb3-380" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-381"><a href="#cb3-381" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">addMarker</span>(container<span class="op">,</span> year<span class="op">,</span> name<span class="op">,</span> ypos) {</span>
<span id="cb3-382"><a href="#cb3-382" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-383"><a href="#cb3-383" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> marker <span class="op">=</span> container<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb3-384"><a href="#cb3-384" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-385"><a href="#cb3-385" aria-hidden="true" tabindex="-1"></a>      marker<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb3-386"><a href="#cb3-386" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> <span class="vs">`M</span><span class="sc">${</span> <span class="fu">x</span>(year) <span class="sc">}</span><span class="vs">,</span><span class="sc">${</span> <span class="fu">y</span>(<span class="dv">0</span>) <span class="sc">}</span><span class="vs"> V</span><span class="sc">${</span> <span class="fu">y</span>(<span class="dv">1</span>) <span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb3-387"><a href="#cb3-387" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke"</span><span class="op">,</span> <span class="st">"black"</span>)</span>
<span id="cb3-388"><a href="#cb3-388" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">style</span>(<span class="st">"stroke-dasharray"</span><span class="op">,</span> <span class="st">"4 2"</span>)<span class="op">;</span></span>
<span id="cb3-389"><a href="#cb3-389" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-390"><a href="#cb3-390" aria-hidden="true" tabindex="-1"></a>      marker<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb3-391"><a href="#cb3-391" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb3-392"><a href="#cb3-392" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"start"</span>)</span>
<span id="cb3-393"><a href="#cb3-393" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">style</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">".9rem"</span>)</span>
<span id="cb3-394"><a href="#cb3-394" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(year))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(ypos))</span>
<span id="cb3-395"><a href="#cb3-395" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="dv">10</span>)</span>
<span id="cb3-396"><a href="#cb3-396" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb3-397"><a href="#cb3-397" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(name)</span>
<span id="cb3-398"><a href="#cb3-398" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="fu">append</span>(<span class="st">"tspan"</span>)</span>
<span id="cb3-399"><a href="#cb3-399" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">text</span>(<span class="st">"Tariff Act"</span>)</span>
<span id="cb3-400"><a href="#cb3-400" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="fu">x</span>(year))<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="fu">y</span>(ypos))</span>
<span id="cb3-401"><a href="#cb3-401" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="dv">10</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></span>
<span id="cb3-402"><a href="#cb3-402" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-403"><a href="#cb3-403" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-404"><a href="#cb3-404" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chart sources ////////////////////////////</span></span>
<span id="cb3-405"><a href="#cb3-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-406"><a href="#cb3-406" aria-hidden="true" tabindex="-1"></a>    container<span class="op">.</span><span class="fu">append</span>(<span class="st">"div"</span>)</span>
<span id="cb3-407"><a href="#cb3-407" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"ojs-source"</span>)</span>
<span id="cb3-408"><a href="#cb3-408" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"margin"</span><span class="op">,</span> <span class="st">".5rem 0"</span>)</span>
<span id="cb3-409"><a href="#cb3-409" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">style</span>(<span class="st">"line-height"</span><span class="op">,</span> <span class="fl">1.25</span>)</span>
<span id="cb3-410"><a href="#cb3-410" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">html</span>(<span class="vs">`Source: Philippine Bureau of Customs, &lt;i&gt;Report&lt;/i&gt; (1940), Table 7, pp. 105–106.`</span>)<span class="op">;</span></span>
<span id="cb3-411"><a href="#cb3-411" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-412"><a href="#cb3-412" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> container<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb3-413"><a href="#cb3-413" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="expression">

</div>
</div>
</div>
<p>When independence did come in 1946, the U.S., suddenly awake to the threat of communism in the Pacific, imposed a thoroughly lopsided <a href="https://en.wikipedia.org/wiki/Bell_Trade_Act">trade agreement</a> on its former colony that, among others, granted Americans the same rights to Philippine natural resources that Filipinos did. It offered an extension of free trade in exchange. The Philippine president, a member of a prominent business clan, <a href="https://online.ucpress.edu/phr/article-abstract/49/3/499/66707/Philippine-Acceptance-of-the-Bell-Trade-Act-of?redirectedFrom=fulltext">rammed the measure</a> through Congress, unseating uncooperative representatives to secure the votes.</p>
<p>Tariff policy can be thought of as a way of keeping some products out while letting others in. Much of trade negotiations is a jostling to be among the privileged few who are let in. One hundred years ago, the Philippines received such a privilege. It turned out to be a very mixed blessing. <img src="../../images/logo-icon.png" class="endmark img-fluid"></p>
</section>



<div id="quarto-appendix" class="default"><section id="data" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Data</h2><div class="quarto-appendix-contents">

<ul>
<li><a href="../../datasets/sugar/sugarexp.csv">Philippine sugar exports, metric tons, 1836–1938</a></li>
<li><a href="../../datasets/sugar/exports.csv">Philippine exports, pesos, 1899–1938</a></li>
</ul>
</div></section><section id="d3-observable-code" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">D3 / Observable code</h2><div class="quarto-appendix-contents">

<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" data-startfrom="431" data-source-offset="-1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 430;"><span id="cb4-431"><a href="#cb4-431" aria-hidden="true" tabindex="-1"></a>sugarexp <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"../../datasets/sugar/sugarexp.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({ <span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">;</span></span>
<span id="cb4-432"><a href="#cb4-432" aria-hidden="true" tabindex="-1"></a>exports <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"../../datasets/sugar/exports.csv"</span>)<span class="op">.</span><span class="fu">csv</span>({ <span class="dt">typed</span><span class="op">:</span> <span class="kw">true</span> })<span class="op">;</span></span>
<span id="cb4-433"><a href="#cb4-433" aria-hidden="true" tabindex="-1"></a>map <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"../../datasets/maps/world_map.json"</span>)<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb4-434"><a href="#cb4-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-435"><a href="#cb4-435" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> ({ </span>
<span id="cb4-436"><a href="#cb4-436" aria-hidden="true" tabindex="-1"></a>  <span class="dt">blue</span><span class="op">:</span> <span class="st">"#4889ab"</span><span class="op">,</span> </span>
<span id="cb4-437"><a href="#cb4-437" aria-hidden="true" tabindex="-1"></a>  <span class="dt">red</span><span class="op">:</span> <span class="st">"#C85B89"</span><span class="op">,</span></span>
<span id="cb4-438"><a href="#cb4-438" aria-hidden="true" tabindex="-1"></a>  <span class="dt">land</span><span class="op">:</span> <span class="st">"#eeeeee"</span><span class="op">,</span></span>
<span id="cb4-439"><a href="#cb4-439" aria-hidden="true" tabindex="-1"></a>  <span class="dt">border</span><span class="op">:</span> <span class="st">"#c0d7df"</span></span>
<span id="cb4-440"><a href="#cb4-440" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-2" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-3" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-4-4" data-nodetype="declaration">

</div>
</div>
</div>
</div>


</div></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section></div></main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IntcbiAgICBjb25zdCBkaW0gPSB7IHdpZHRoOiA3OTAsIGhlaWdodDogNDAwIH07XG5cbiAgICBjb25zdCBkYXRhID0gdG9wb2pzb24uZmVhdHVyZShtYXAsIG1hcC5vYmplY3RzLmNvdW50cmllcyk7XG4gICAgXG4gICAgLy8gQ2hhcnQgdGl0bGUgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gIFxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGQzLmNyZWF0ZShcImRpdlwiKTtcbiAgICBcbiAgICBjb250YWluZXIuYXBwZW5kKFwiZGl2XCIpXG4gICAgICAuYXR0cihcImNsYXNzXCIsIFwib2pzLXRpdGxlXCIpXG4gICAgICAudGV4dChcIkJlbmV2b2xlbnQgYXNzaW1pbGF0aW9uXCIpO1xuICAgICAgXG4gICAgY29udGFpbmVyLmFwcGVuZChcImRpdlwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcIm9qcy1zdWJ0aXRsZVwiKVxuICAgICAgLnN0eWxlKFwibWFyZ2luLWJvdHRvbVwiLCBcIjFyZW1cIilcbiAgICAgIC50ZXh0KFwiVGhlIFVuaXRlZCBTdGF0ZXMgYW5kIHRoZSBQaGlsaXBwaW5lc1wiKTtcblxuICAgIC8vIE1hcCAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIFxuICAgIGNvbnN0IHByb2plY3Rpb24gPSBkMy5nZW9OYXR1cmFsRWFydGgxKClcbiAgICAgIC5zY2FsZSgxNTApXG4gICAgICAuY2VudGVyKFs1MCwgLTEwXSk7XG4gICAgICBcbiAgICBjb25zdCBwYXRoID0gZDMuZ2VvUGF0aCgpLnByb2plY3Rpb24ocHJvamVjdGlvbik7XG4gICAgXG4gICAgY29uc3Qgc3ZnID0gY29udGFpbmVyLmFwcGVuZChcInN2Z1wiKVxuICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBcIjEwMCVcIilcbiAgICAgIC5hdHRyKFwidmlld0JveFwiLCBbMCwgMCwgZGltLndpZHRoLCBkaW0uaGVpZ2h0XSk7XG4gICAgICBcbiAgICBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgICAgLnNlbGVjdEFsbChcInBhdGhcIilcbiAgICAgIC5kYXRhKGRhdGEuZmVhdHVyZXMpXG4gICAgICAuam9pbihcInBhdGhcIilcbiAgICAgIC5hdHRyKFwiZFwiLCBwYXRoKVxuICAgICAgLmF0dHIoXCJmaWxsXCIsIGQgPT4ge1xuICAgICAgICBzd2l0Y2goZC5wcm9wZXJ0aWVzLmlzbzNjKSB7XG4gICAgICAgICAgY2FzZSBcIlVTQVwiOiBcbiAgICAgICAgICAgIHJldHVybiBjb2xvcnMuYmx1ZTtcbiAgICAgICAgICBjYXNlIFwiUEhMXCI6IFxuICAgICAgICAgICAgcmV0dXJuIGNvbG9ycy5ibHVlO1xuICAgICAgICAgIGRlZmF1bHQ6IFxuICAgICAgICAgICAgcmV0dXJuIGNvbG9ycy5sYW5kO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnN0eWxlKFwic3Ryb2tlXCIsIFwibm9uZVwiKTtcbiAgICBcbiAgICAvLyBDaGFydCBzb3VyY2VzIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIGNvbnRhaW5lci5hcHBlbmQoXCJkaXZcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJvanMtc291cmNlXCIpXG4gICAgICAuc3R5bGUoXCJtYXJnaW5cIiwgXCIuNXJlbSAwXCIpXG4gICAgICAuc3R5bGUoXCJsaW5lLWhlaWdodFwiLCAxLjI1KVxuICAgICAgLmh0bWwoYFwiV2hlbiB3ZSByZWNlaXZlZCB0aGUgY2FibGUgZnJvbSBBZG1pcmFsIERld2V5IHRlbGxpbmcgb2YgdGhlIHRha2luZyBvZiB0aGUgUGhpbGlwcGluZXMgSSBsb29rZWQgdXAgdGhlaXIgbG9jYXRpb24gb24gdGhlIGdsb2JlLiBJIGNvdWxkIG5vdCBoYXZlIHRvbGQgd2hlcmUgdGhvc2UgZGFybmVkIGlzbGFuZHMgd2VyZSB3aXRoaW4gMiwwMDAgbWlsZXMhXCIg4oCTIFdpbGxpYW0gTWNLaW5sZXksIHF1b3RlZCBpbiBILiBILiBLb2hsc2FhdCwgPGEgaHJlZj0naHR0cHM6Ly9kbjc5MDAwNy5jYS5hcmNoaXZlLm9yZy8wL2l0ZW1zL2Zyb21tY2tpbmxleXRvaGEwMGtvaGwvZnJvbW1ja2lubGV5dG9oYTAwa29obC5wZGYnPjxpPkZyb20gTWNLaW5sZXkgdG8gSGFyZGluZzwvaT48L2E+ICgxOTIzKSwgcC4gNjguYCk7XG4gICAgXG4gIHJldHVybiBjb250YWluZXIubm9kZSgpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0yIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAgIGNvbnN0IGRpbSA9IHsgd2lkdGg6IDc5MCwgaGVpZ2h0OiA1NTAgfTtcbiAgICBjb25zdCBtYXJnaW4gPSB7IHRvcDogMjAsIHJpZ2h0OiAwLCBib3R0b206IDUwLCBsZWZ0OiA1MCB9O1xuICAgIGNvbnN0IGd1dHRlciA9IHsgeDogMTIuNSwgeTogMTIuNSwgeWluOiAxMCB9O1xuICAgIFxuICAgIGNvbnN0IGRhdGEgPSBzdWdhcmV4cDtcbiAgICBcbiAgICBjb25zdCB4ID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgICAgLmRvbWFpbihkMy5leHRlbnQoZGF0YSwgZCA9PiBkLnQpKVxuICAgICAgLnJhbmdlKFttYXJnaW4ubGVmdCArIGd1dHRlci55aW4sIGRpbS53aWR0aCAtIG1hcmdpbi5yaWdodCAtIGd1dHRlci55aW5dKTtcbiAgICBcbiAgICBjb25zdCB5ID0gZDMuc2NhbGVMaW5lYXIoKVxuICAgICAgLmRvbWFpbihkMy5leHRlbnQoZGF0YSwgZCA9PiBkLm4pKVxuICAgICAgLnJhbmdlKFtkaW0uaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSwgbWFyZ2luLnRvcF0pO1xuICAgIFxuICAgIC8vIENoYXJ0IHRpdGxlIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICBcbiAgICBjb25zdCBjb250YWluZXIgPSBkMy5jcmVhdGUoXCJkaXZcIik7XG4gICAgXG4gICAgY29udGFpbmVyLmFwcGVuZChcImRpdlwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcIm9qcy10aXRsZVwiKVxuICAgICAgLnRleHQoXCJTdWdhciBydXNoXCIpO1xuICAgICAgXG4gICAgY29udGFpbmVyLmFwcGVuZChcImRpdlwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcIm9qcy1zdWJ0aXRsZVwiKVxuICAgICAgLnN0eWxlKFwibWFyZ2luLWJvdHRvbVwiLCBcIjFyZW1cIilcbiAgICAgIC50ZXh0KFwiUGhpbGlwcGluZSBzdWdhciBleHBvcnRzIGluIG1ldHJpYyB0b25zLCAxODM24oCTMTkzOFwiKTtcbiAgICBcbiAgICAvLyBMaW5lIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICBcbiAgICBjb25zdCBzdmcgPSBjb250YWluZXIuYXBwZW5kKFwic3ZnXCIpXG4gICAgICAuYXR0cihcIndpZHRoXCIsIFwiMTAwJVwiKVxuICAgICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCBkaW0ud2lkdGgsIGRpbS5oZWlnaHRdKTtcbiAgICBcbiAgICBjb25zdCBsaW5lID0gZDMubGluZSgpXG4gICAgICAuY3VydmUoZDMuY3VydmVCYXNpcylcbiAgICAgIC54KGQgPT4geChkLnQpKVxuICAgICAgLnkoZCA9PiB5KGQubikpO1xuICAgIFxuICAgIGNvbnN0IGxpbmVzID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAgIC5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAuZGF0dW0oZGF0YSlcbiAgICAgIC5hdHRyKFwiZFwiLCBsaW5lKVxuICAgICAgLnN0eWxlKFwiZmlsbFwiLCBcIm5vbmVcIilcbiAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBjb2xvcnMuYmx1ZSlcbiAgICAgIC5zdHlsZShcInN0cm9rZS13aWR0aFwiLCA1KTtcbiAgICBcbiAgICAvLyBBeGVzIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICBcbiAgICBjb25zdCB4QXhpcyA9IGQzLmF4aXNCb3R0b20oeClcbiAgICAgIC50aWNrRm9ybWF0KGQzLmZvcm1hdChcIi4wZlwiKSlcbiAgICAgIC50aWNrU2l6ZSgwKVxuICAgICAgLnRpY2tQYWRkaW5nKFtndXR0ZXIueF0pO1xuICAgIFxuICAgIGNvbnN0IHlBeGlzID0gZDMuYXhpc0xlZnQoeSlcbiAgICAgIC50aWNrcyg1LCBcIi4xc1wiKVxuICAgICAgLnRpY2tTaXplKDApXG4gICAgICAudGlja1BhZGRpbmcoW2d1dHRlci55XSk7XG4gICAgICBcbiAgICBjb25zdCB4QXhpc0dyb3VwID0gc3ZnLmFwcGVuZChcImdcIilcbiAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoMCwgJHsgZGltLmhlaWdodCAtIG1hcmdpbi5ib3R0b20gfSlgKVxuICAgICAgLmNhbGwoeEF4aXMpO1xuICAgIFxuICAgIGNvbnN0IHlBeGlzR3JvdXAgPSBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgkeyBtYXJnaW4ubGVmdCB9LCAwKWApXG4gICAgICAuY2FsbCh5QXhpcylcbiAgICAgIC5jYWxsKGcgPT4gZy5zZWxlY3QoXCIuZG9tYWluXCIpLnJlbW92ZSgpKVxuICAgICAgLmNhbGwoZyA9PiBnLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgLmF0dHIoXCJ4XCIsIC1tYXJnaW4ubGVmdClcbiAgICAgICAgLmF0dHIoXCJ5XCIsIG1hcmdpbi50b3AgKyAyMClcbiAgICAgICAgLmF0dHIoXCJmaWxsXCIsIFwiYmxhY2tcIilcbiAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcInN0YXJ0XCIpXG4gICAgICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBcIi45cmVtXCIpXG4gICAgICAgIC50ZXh0KFwiTWV0cmljIHRvbnNcIikpO1xuICAgICAgXG4gICAgeEF4aXNHcm91cC5zZWxlY3RBbGwoXCJ0ZXh0XCIpLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiLjhyZW1cIik7XG4gICAgeUF4aXNHcm91cC5zZWxlY3RBbGwoXCJ0ZXh0XCIpLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiLjhyZW1cIik7XG4gICAgXG4gICAgLy8gQW5ub3RhdGlvbnMgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIFxuICAgIHN2Zy5jYWxsKGFkZE1hcmtlciwgMTkwOSwgXCJQYXluZeKAk0FsZHJpY2hcIiwgNDAwKTtcbiAgICBzdmcuY2FsbChhZGRNYXJrZXIsIDE5MzAsIFwiU21vb3TigJNIYXdsZXlcIiwgNDAwKTtcbiAgICBcbiAgICBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgICAgLmFwcGVuZChcInRleHRcIilcbiAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcImVuZFwiKVxuICAgICAgICAuc3R5bGUoXCJmb250LXNpemVcIiwgXCIuOXJlbVwiKVxuICAgICAgICAuYXR0cihcInhcIiwgeCgxOTA5KSkuYXR0cihcInlcIiwgZGltLmhlaWdodCAtIG1hcmdpbi5ib3R0b20gLSAzNTUpXG4gICAgICAgIC5hdHRyKFwiZHhcIiwgLTEwKVxuICAgICAgLmFwcGVuZChcInRzcGFuXCIpXG4gICAgICAgIC50ZXh0KFwiTXV0dWFsIGZyZWUgdHJhZGVcIilcbiAgICAgIC5hcHBlbmQoXCJ0c3BhblwiKVxuICAgICAgICAudGV4dChcIndpdGggVS5TLlwiKVxuICAgICAgICAuYXR0cihcInhcIiwgeCgxOTA5KSkuYXR0cihcInlcIiwgZGltLmhlaWdodCAtIG1hcmdpbi5ib3R0b20gLSAzNTUpXG4gICAgICAgIC5hdHRyKFwiZHhcIiwgLTEwKS5hdHRyKFwiZHlcIiwgMjApO1xuICAgIFxuICAgIGZ1bmN0aW9uIGFkZE1hcmtlcihjb250YWluZXIsIHllYXIsIG5hbWUsIHlwb3MpIHtcbiAgICAgIFxuICAgICAgY29uc3QgbWFya2VyID0gY29udGFpbmVyLmFwcGVuZChcImdcIilcbiAgICAgIFxuICAgICAgbWFya2VyLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgLmF0dHIoXCJkXCIsIGBNJHsgeCh5ZWFyKSB9LFxuICAgICAgICAgICR7IGRpbS5oZWlnaHQgLSBtYXJnaW4uYm90dG9tIH0gViR7IG1hcmdpbi50b3AgfWBcbiAgICAgICAgKVxuICAgICAgICAuc3R5bGUoXCJzdHJva2VcIiwgXCJibGFja1wiKVxuICAgICAgICAuc3R5bGUoXCJzdHJva2UtZGFzaGFycmF5XCIsIFwiNCAyXCIpO1xuICAgICAgXG4gICAgICBtYXJrZXIuYXBwZW5kKFwiZ1wiKVxuICAgICAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAgIC5hdHRyKFwidGV4dC1hbmNob3JcIiwgXCJlbmRcIilcbiAgICAgICAgICAuc3R5bGUoXCJmb250LXNpemVcIiwgXCIuOXJlbVwiKVxuICAgICAgICAgIC5hdHRyKFwieFwiLCB4KHllYXIpKS5hdHRyKFwieVwiLCBkaW0uaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSAtIHlwb3MpXG4gICAgICAgICAgLmF0dHIoXCJkeFwiLCAtMTApXG4gICAgICAgIC5hcHBlbmQoXCJ0c3BhblwiKVxuICAgICAgICAgIC50ZXh0KG5hbWUpXG4gICAgICAgIC5hcHBlbmQoXCJ0c3BhblwiKVxuICAgICAgICAgIC50ZXh0KFwiVGFyaWZmIEFjdFwiKVxuICAgICAgICAgIC5hdHRyKFwieFwiLCB4KHllYXIpKS5hdHRyKFwieVwiLCBkaW0uaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSAtIHlwb3MpXG4gICAgICAgICAgLmF0dHIoXCJkeFwiLCAtMTApLmF0dHIoXCJkeVwiLCAyMCk7XG4gICAgICAgICAgXG4gICAgICByZXR1cm4gY29udGFpbmVyLm5vZGUoKTtcbiAgICB9XG5cbiAgICAvLyBDaGFydCBzb3VyY2VzIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgIGNvbnRhaW5lci5hcHBlbmQoXCJkaXZcIilcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJvanMtc291cmNlXCIpXG4gICAgICAuc3R5bGUoXCJtYXJnaW5cIiwgXCIuNXJlbSAwXCIpXG4gICAgICAuc3R5bGUoXCJsaW5lLWhlaWdodFwiLCAxLjI1KVxuICAgICAgLmh0bWwoYFNvdXJjZTogSi4gTGFya2luLCA8YSBocmVmPVwiaHR0cHM6Ly9wdWJsaXNoaW5nLmNkbGliLm9yZy91Y3ByZXNzZWJvb2tzL3ZpZXc/ZG9jSWQ9ZnQ0NTgwMDY2ZCZjaHVuay5pZD1kMGUxMTExMyZ0b2MuZGVwdGg9MSZ0b2MuaWQ9JmJyYW5kPXVjcHJlc3MvXCI+PGk+U3VnYXIgYW5kIHRoZSBPcmlnaW5zIG9mIE1vZGVybiBQaGlsaXBwaW5lIFNvY2lldHk8L2k+PC9hPiAoMTk5MyksIEFwcGVuZGl4IEEsIHAuIDI1MDsgUGhpbGlwcGluZSBCdXJlYXUgb2YgQ3VzdG9tcywgPGk+UmVwb3J0PC9pPiAoMTk0MCksIFRhYmxlIDcsIHBwLiAxMDXigJMxMDYuYCk7XG4gICAgXG4gIHJldHVybiBjb250YWluZXIubm9kZSgpO1xufVxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0zIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoie1xuICAgIGNvbnN0IGRpbSA9IHsgd2lkdGg6IDc5MCwgaGVpZ2h0OiA1NTAgfTtcbiAgICBjb25zdCBtYXJnaW4gPSB7IHRvcDogMjAsIHJpZ2h0OiAwLCBib3R0b206IDUwLCBsZWZ0OiA1MCB9O1xuICAgIGNvbnN0IGd1dHRlciA9IHsgeDogMTIuNSwgeTogMTIuNSwgeWluOiAxMCB9O1xuICAgIFxuICAgIGNvbnN0IGRhdGFXaWRlID0gZXhwb3J0cy5tYXAoZCA9PiAoe1xuICAgICAgdDogZC50LFxuICAgICAgc2hfdXNhOiArZC54X3VzYSAvICtkLngsXG4gICAgICBzaF9zdWdfdXNhOiArZC54X3VzYV9zdWcgLyArZC54X3N1Z1xuICAgIH0pKTtcbiAgICBcbiAgICBjb25zdCBkYXRhID0gZGF0YVdpZGUuZmxhdE1hcChkID0+IFtcbiAgICAgIHsgdDogZC50LCB2YXI6IFwic2hfdXNhXCIsIHY6IGQuc2hfdXNhIH0sXG4gICAgICB7IHQ6IGQudCwgdmFyOiBcInNoX3N1Z191c2FcIiwgdjogZC5zaF9zdWdfdXNhIH0sXG4gICAgXSk7XG4gICAgXG4gICAgY29uc3QgeCA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAgIC5kb21haW4oZDMuZXh0ZW50KGRhdGEsIGQgPT4gZC50KSlcbiAgICAgIC5yYW5nZShbbWFyZ2luLmxlZnQgKyBndXR0ZXIueWluLCBkaW0ud2lkdGggLSBtYXJnaW4ucmlnaHQgLSBndXR0ZXIueWluXSk7XG4gICAgXG4gICAgY29uc3QgeSA9IGQzLnNjYWxlTGluZWFyKClcbiAgICAgIC5kb21haW4oWzAsIDFdKVxuICAgICAgLnJhbmdlKFtkaW0uaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSwgbWFyZ2luLnRvcF0pO1xuICAgIFxuICAgIC8vIENoYXJ0IHRpdGxlIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICBcbiAgICBjb25zdCBjb250YWluZXIgPSBkMy5jcmVhdGUoXCJkaXZcIik7XG4gICAgXG4gICAgY29udGFpbmVyLmFwcGVuZChcImRpdlwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcIm9qcy10aXRsZVwiKVxuICAgICAgLnRleHQoXCJQdXJjaGFzaW5nIHBvd2VyXCIpO1xuICAgICAgXG4gICAgY29udGFpbmVyLmFwcGVuZChcImRpdlwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcIm9qcy1zdWJ0aXRsZVwiKVxuICAgICAgLnN0eWxlKFwibWFyZ2luLWJvdHRvbVwiLCBcIjFyZW1cIilcbiAgICAgIC50ZXh0KFwiVGhlIFVuaXRlZCBTdGF0ZXMgaW4gUGhpbGlwcGluZSBleHBvcnRzLCAxODk54oCTMTkzOFwiKTtcbiAgICBcbiAgICAvLyBMaW5lIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICBcbiAgICBjb25zdCBzdmcgPSBjb250YWluZXIuYXBwZW5kKFwic3ZnXCIpXG4gICAgICAuYXR0cihcIndpZHRoXCIsIFwiMTAwJVwiKVxuICAgICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCBkaW0ud2lkdGgsIGRpbS5oZWlnaHRdKVxuICAgIFxuICAgIGNvbnN0IGdyb3VwcyA9IGQzLmdyb3VwKGRhdGEsIGQgPT4gZC52YXIpO1xuXG4gICAgY29uc3QgbGluZSA9IGQzLmxpbmUoKVxuICAgICAgLmN1cnZlKGQzLmN1cnZlQmFzaXMpXG4gICAgICAueChkID0+IHgoZC50KSlcbiAgICAgIC55KGQgPT4geShkLnYpKTtcbiAgICAgIFxuICAgIGNvbnN0IGNvbG9yID0gZDMuc2NhbGVPcmRpbmFsKClcbiAgICAgIC5kb21haW4oW1wic2hfdXNhXCIsIFwic2hfc3VnX3VzYVwiXSlcbiAgICAgIC5yYW5nZShbY29sb3JzLmJsdWUsIGNvbG9ycy5yZWRdKTtcbiAgICBcbiAgICBjb25zdCBsaW5lcyA9IHN2Zy5hcHBlbmQoXCJnXCIpO1xuICAgIFxuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVzXSBvZiBncm91cHMpIHtcbiAgICAgIGxpbmVzLmFwcGVuZChcImdcIilcbiAgICAgICAgLmFwcGVuZChcInBhdGhcIilcbiAgICAgICAgLmRhdHVtKHZhbHVlcylcbiAgICAgICAgLmF0dHIoXCJkXCIsIGxpbmUpXG4gICAgICAgIC5zdHlsZShcImZpbGxcIiwgXCJub25lXCIpXG4gICAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBjb2xvcihrZXkpKVxuICAgICAgICAuc3R5bGUoXCJzdHJva2Utd2lkdGhcIiwgNSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEF4ZXMgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIFxuICAgIGNvbnN0IHhBeGlzID0gZDMuYXhpc0JvdHRvbSh4KVxuICAgICAgLnRpY2tGb3JtYXQoZDMuZm9ybWF0KFwiLjBmXCIpKVxuICAgICAgLnRpY2tTaXplKDApXG4gICAgICAudGlja1BhZGRpbmcoW2d1dHRlci54XSk7XG4gICAgXG4gICAgY29uc3QgeUF4aXMgPSBkMy5heGlzTGVmdCh5KVxuICAgICAgLnRpY2tzKDUsIFwiLjAlXCIpXG4gICAgICAudGlja1NpemUoMClcbiAgICAgIC50aWNrUGFkZGluZyhbZ3V0dGVyLnldKTtcbiAgICAgIFxuICAgIGNvbnN0IHhBeGlzR3JvdXAgPSBzdmcuYXBwZW5kKFwiZ1wiKVxuICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgwLCAkeyBkaW0uaGVpZ2h0IC0gbWFyZ2luLmJvdHRvbSB9KWApXG4gICAgICAuY2FsbCh4QXhpcyk7XG4gICAgXG4gICAgY29uc3QgeUF4aXNHcm91cCA9IHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7IG1hcmdpbi5sZWZ0IH0sIDApYClcbiAgICAgIC5jYWxsKHlBeGlzKVxuICAgICAgLmNhbGwoZyA9PiBnLnNlbGVjdChcIi5kb21haW5cIikucmVtb3ZlKCkpO1xuICAgICAgXG4gICAgeEF4aXNHcm91cC5zZWxlY3RBbGwoXCJ0ZXh0XCIpLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiLjhyZW1cIik7XG4gICAgeUF4aXNHcm91cC5zZWxlY3RBbGwoXCJ0ZXh0XCIpLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiLjhyZW1cIik7XG4gICAgXG4gICAgLy8gQW5ub3RhdGlvbnMgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgIFxuICAgIHN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAuYXBwZW5kKFwidGV4dFwiKVxuICAgICAgICAuYXR0cihcInhcIiwgeCgxOTIzKSkuYXR0cihcInlcIiwgeSguNjQpKVxuICAgICAgICAuc3R5bGUoXCJ0ZXh0LWFuY2hvclwiLCBcInN0YXJ0XCIpXG4gICAgICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBcIi45cmVtXCIpXG4gICAgICAgIC5zdHlsZShcImZvbnQtd2VpZ2h0XCIsIFwiYm9sZFwiKVxuICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIGNvbG9ycy5ibHVlKVxuICAgICAgLmFwcGVuZChcInRzcGFuXCIpXG4gICAgICAgIC50ZXh0KFwiU2hhcmUgb2YgVS5TLlwiKVxuICAgICAgLmFwcGVuZChcInRzcGFuXCIpXG4gICAgICAgIC50ZXh0KFwiaW4gdG90YWwgZXhwb3J0c1wiKVxuICAgICAgICAuYXR0cihcInhcIiwgeCgxOTIzKSkuYXR0cihcInlcIiwgeSguNjQpKVxuICAgICAgICAuYXR0cihcImR5XCIsIDIwKTtcbiAgICAgICAgXG4gICAgc3ZnLmFwcGVuZChcImdcIilcbiAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgIC5hdHRyKFwieFwiLCB4KDE5MjUpKS5hdHRyKFwieVwiLCB5KC45OCkpXG4gICAgICAgIC5zdHlsZShcInRleHQtYW5jaG9yXCIsIFwiZW5kXCIpXG4gICAgICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCBcIi45cmVtXCIpXG4gICAgICAgIC5zdHlsZShcImZvbnQtd2VpZ2h0XCIsIFwiYm9sZFwiKVxuICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIGNvbG9ycy5yZWQpXG4gICAgICAuYXBwZW5kKFwidHNwYW5cIilcbiAgICAgICAgLnRleHQoXCJTaGFyZSBvZiBVLlMuXCIpXG4gICAgICAuYXBwZW5kKFwidHNwYW5cIilcbiAgICAgICAgLnRleHQoXCJpbiBzdWdhciBleHBvcnRzXCIpXG4gICAgICAgIC5hdHRyKFwieFwiLCB4KDE5MjUpKS5hdHRyKFwieVwiLCB5KC45OCkpXG4gICAgICAgIC5hdHRyKFwiZHlcIiwgMjApO1xuICAgIFxuICAgIHN2Zy5jYWxsKGFkZE1hcmtlciwgMTkwOSwgXCJQYXluZeKAk0FsZHJpY2hcIiwgLjA3NSk7XG4gICAgc3ZnLmNhbGwoYWRkTWFya2VyLCAxOTMwLCBcIlNtb2904oCTSGF3bGV5XCIsIC4wNzUpO1xuICAgIFxuICAgIGZ1bmN0aW9uIGFkZE1hcmtlcihjb250YWluZXIsIHllYXIsIG5hbWUsIHlwb3MpIHtcbiAgICAgIFxuICAgICAgY29uc3QgbWFya2VyID0gY29udGFpbmVyLmFwcGVuZChcImdcIik7XG4gICAgICBcbiAgICAgIG1hcmtlci5hcHBlbmQoXCJwYXRoXCIpXG4gICAgICAgIC5hdHRyKFwiZFwiLCBgTSR7IHgoeWVhcikgfSwkeyB5KDApIH0gViR7IHkoMSkgfWApXG4gICAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBcImJsYWNrXCIpXG4gICAgICAgIC5zdHlsZShcInN0cm9rZS1kYXNoYXJyYXlcIiwgXCI0IDJcIik7XG4gICAgICBcbiAgICAgIG1hcmtlci5hcHBlbmQoXCJnXCIpXG4gICAgICAgIC5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcInN0YXJ0XCIpXG4gICAgICAgICAgLnN0eWxlKFwiZm9udC1zaXplXCIsIFwiLjlyZW1cIilcbiAgICAgICAgICAuYXR0cihcInhcIiwgeCh5ZWFyKSkuYXR0cihcInlcIiwgeSh5cG9zKSlcbiAgICAgICAgICAuYXR0cihcImR4XCIsIDEwKVxuICAgICAgICAuYXBwZW5kKFwidHNwYW5cIilcbiAgICAgICAgICAudGV4dChuYW1lKVxuICAgICAgICAuYXBwZW5kKFwidHNwYW5cIilcbiAgICAgICAgICAudGV4dChcIlRhcmlmZiBBY3RcIilcbiAgICAgICAgICAuYXR0cihcInhcIiwgeCh5ZWFyKSkuYXR0cihcInlcIiwgeSh5cG9zKSlcbiAgICAgICAgICAuYXR0cihcImR4XCIsIDEwKS5hdHRyKFwiZHlcIiwgMjApO1xuICAgIH1cbiAgICAgIFxuICAgIC8vIENoYXJ0IHNvdXJjZXMgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgY29udGFpbmVyLmFwcGVuZChcImRpdlwiKVxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcIm9qcy1zb3VyY2VcIilcbiAgICAgIC5zdHlsZShcIm1hcmdpblwiLCBcIi41cmVtIDBcIilcbiAgICAgIC5zdHlsZShcImxpbmUtaGVpZ2h0XCIsIDEuMjUpXG4gICAgICAuaHRtbChgU291cmNlOiBQaGlsaXBwaW5lIEJ1cmVhdSBvZiBDdXN0b21zLCA8aT5SZXBvcnQ8L2k+ICgxOTQwKSwgVGFibGUgNywgcHAuIDEwNeKAkzEwNi5gKTtcbiAgICBcbiAgcmV0dXJuIGNvbnRhaW5lci5ub2RlKCk7XG59XG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcbnN1Z2FyZXhwID0gRmlsZUF0dGFjaG1lbnQoXCIuLi8uLi9kYXRhc2V0cy9zdWdhci9zdWdhcmV4cC5jc3ZcIikuY3N2KHsgdHlwZWQ6IHRydWUgfSk7XG5leHBvcnRzID0gRmlsZUF0dGFjaG1lbnQoXCIuLi8uLi9kYXRhc2V0cy9zdWdhci9leHBvcnRzLmNzdlwiKS5jc3YoeyB0eXBlZDogdHJ1ZSB9KTtcbm1hcCA9IEZpbGVBdHRhY2htZW50KFwiLi4vLi4vZGF0YXNldHMvbWFwcy93b3JsZF9tYXAuanNvblwiKS5qc29uKCk7XG5cbmNvbG9ycyA9ICh7IFxuICBibHVlOiBcIiM0ODg5YWJcIiwgXG4gIHJlZDogXCIjQzg1Qjg5XCIsXG4gIGxhbmQ6IFwiI2VlZWVlZVwiLFxuICBib3JkZXI6IFwiI2MwZDdkZlwiXG59KTtcblxuIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../posts/2025-04-09-to-seek-anothers-profit";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "../..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/twopoints\.blog");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>